<!DOCTYPE html>
<html lang="en">
<head>
	<title>Cart</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!--===============================================================================================-->
	<link rel="icon" type="image/png" href="images/icons/favicon.png"/>
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/themify/themify-icons.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/Linearicons-Free-v1.0.0/icon-font.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/elegant-font/html-css/style.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/slick/slick.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css/util.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
<!--===============================================================================================-->

//<script src="https://js.stripe.com/v3/"></script>

</head>
<body class="animsition" onload= loadAllFunctions()>
	

	<!-- top noti -->
	<div class="flex-c-m size22 bg0 s-text21 pos-relative">
			Point to Point Communication
	</div>

	<!-- Header -->
	<header class="header1">
		

			<div class="wrap_header">
				<!-- Logo -->
				<a href="index.html" class="logo">
					<img src="images/icons/logo.png" alt="IMG-LOGO">
				</a>

				<!-- Menu -->
				<div class="wrap_menu">
					<nav class="menu">
						<ul class="main_menu">
							<li>
								<a href="index.html">Home</a>
							</li>

							<li>
								<a href="product.html">Shop</a>
							</li>


							<li>
								<a href="about.html">About</a>
							</li>

							<li>
								<a href="contact.html">Contact</a>
							</li>
							<li>
									<a href="companies.html">Corporate</a>
								</li>


						</ul>
					</nav>
				</div>

				<!-- Header Icon -->
				<div class="header-icons">
						<span class="topbar-id"></span>
					<a href="#" class="header-wrapicon1 dis-block">
						<img src="images/icons/icon-header-01.png" class="header-icon1" alt="ICON">
					</a>

					<span class="linedivide1"></span>

					<div class="header-wrapicon2">
						<img src="images/icons/icon-header-02.png" class="header-icon1 js-show-header-dropdown" alt="ICON">
						<span class="header-icons-noti" id="counter"></span>

						<script>
						var number = sessionStorage.getItem("item");
						var cart = JSON.parse(sessionStorage.getItem(number)); //edit promotion to allow cart to take the place of items added to cart
						//console.log(cart);
						//var counter = cart.length; //counter = number of items in cart
						document.getElementById("counter").innerHTML = "1";
						</script>

						<!-- Header cart noti -->
						<div class="header-cart header-dropdown">
							<ul class="header-cart-wrapitem">
								<li class = "insert-header">

								</li>

								
							</ul>

							<div class="header-cart-total">
								<!-- Total: $<p id="header_total"></p>  -->
								<span id="total_price"></span>
							</div>


							<div class="header-cart-buttons">
								<div class="header-cart-wrapbtn">
									<!-- Button -->
									<a href="cart.html" class="flex-c-m size1 bg1 bo-rad-20 hov1 s-text1 trans-0-4">
										View Cart
									</a>
								</div>

								<div class="header-cart-wrapbtn">
									<!-- Button -->
									<a href="#" class="flex-c-m size1 bg1 bo-rad-20 hov1 s-text1 trans-0-4">
										Check Out
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Header Mobile -->
		<div class="wrap_header_mobile">
			<!-- Logo moblie -->
			<a href="index.html" class="logo-mobile">
				<img src="images/icons/logo.png" alt="IMG-LOGO">
			</a>

			<!-- Button show menu -->
			<div class="btn-show-menu">
				<!-- Header Icon mobile -->
				<div class="header-icons-mobile">
					<a href="#" class="header-wrapicon1 dis-block">
						<img src="images/icons/icon-header-01.png" class="header-icon1" alt="ICON">
					</a>

					<span class="linedivide2"></span>

					<div class="header-wrapicon2">
						<img src="images/icons/icon-header-02.png" class="header-icon1 js-show-header-dropdown" alt="ICON">
						<span class="header-icons-noti">0</span>

						<!-- Header cart noti -->
						
					</div>
				</div>

				<div class="btn-show-menu-mobile hamburger hamburger--squeeze">
					<span class="hamburger-box">
						<span class="hamburger-inner"></span>
					</span>
				</div>
			</div>
		</div>

		<!-- Menu Mobile -->
		
	</header>

	<!-- Title Page -->
	<section class="bg-title-page p-t-40 p-b-50 flex-col-c-m" style="background-image: url(images/heading-pages-01.jpg);">
		<h2 class="l-text2 t-center" >
			<font color="black"> Cart </font>
		</h2>
	</section>

	<!-- Cart -->
	<section class="cart bgwhite p-t-70 p-b-100">
		<div class="container">
			<!-- Cart item -->
			<div class="container-table-cart pos-relative">
				<div class="wrap-table-shopping-cart bgwhite">
					<table class="table-shopping-cart">
						<tr class="table-head">
							<th class="column-1"></th>
							<th class="column-2">Product</th>
							<th class="column-3">Price</th>
							<th class="column-1 p-l-70">Quantity</th>
							<th class="column-4">Total</th>
							<tr class ="insert-item">


							</tr>
						</tr>
						
						
						
						</tr>
					</table>
				</div>
			</div>

			

			<!-- Total -->
			<div class="bo9 w-size18 p-l-40 p-r-40 p-t-30 p-b-38 m-t-30 m-r-0 m-l-auto p-lr-15-sm">
				<h5 class="m-text20 p-b-24">
					Cart Total
				</h5>

				<!--  -->
				<div class="flex-w flex-sb-m p-b-12">
					<span class="s-text18 w-size19 w-full-sm" id="subtotal">
						
					</span>

						<span class="m-text21 w-size20 w-full-sm" id="subtotal">
						<!-- id="subtotal" links to javascript where var total_price will be input here-->
					</span>
				</div>
				
				
				

				<!--  -->
				<div class="flex-w flex-sb bo10 p-t-15 p-b-20">
					<span class="s-text18 w-size19 w-full-sm">
						Shipping:
					</span>

					<div class="w-size20 w-full-sm">
						<p class="s-text8 p-b-23">
							
						</p>

						<span class="s-text19">
							Calculate Shipping
						</span>

						<form id="shipping">
								<div class="rs2-select2 rs3-select2 rs4-select2 bo4 of-hidden w-size21 m-t-8 m-b-12">
										<select class="selection-2" name="country" id='slt_country'>
											<option>Select a country</option>
											<option  value="CN">China</option>
											<option  value="ID">Indonesia</option>
											<option  value="JP">Japan</option>
											<option  value="MY">Malaysia</option>
											<option  value="SG">Singapore</option>
											<option  value="US">United States</option>										
											
										</select>
								</div>
				
								<div class="size13 bo4 m-b-22">
										<input class="sizefull s-text7 p-l-15 p-r-15" type="text" name="postcode" placeholder="Postal Code" id="postal">
								</div>
				
								<div class="size14 trans-0-4 m-b-10">
										<!-- Button -->
										
										<button class="flex-c-m sizefull bg1 bo-rad-23 hov1 s-text1 trans-0-4" id="submit" type="button">Update Cart</button>
								</div>  
						</form>
					</div>
				</div>

				<!--  -->
				<div class="flex-w flex-sb-m p-t-26 p-b-30">
					<span class="m-text22 w-size19 w-full-sm">
						Cart Total:
					</span>

					<span class="m-text21 w-size20 w-full-sm" id="cart_total">
						
					</span>
				</div>

				<!-- <form action="index.html" method="POST">
						<script
						  src="https://checkout.stripe.com/checkout.js" class="stripe-button"
						  data-key="pk_test_OQCRdigC0WDmT4zh63DpNQEh00Mg9gLiVm"
						  data-amount= ""	
						  data-name="Fashe"
						  data-description="O$P$"
						  data-image="images/icons/yilong.png"
						  data-locale="auto">
						</script>
					  </form> -->
			</div>
		</div>
	</section>




	<!-- Back to top -->
	<div class="btn-back-to-top bg0-hov" id="myBtn">
		<span class="symbol-btn-back-to-top">
			<i class="fa fa-angle-double-up" aria-hidden="true"></i>
		</span>
	</div>

	<!-- Container Selection -->
	<div id="dropDownSelect1"></div>
	<div id="dropDownSelect2"></div>



<!--===============================================================================================-->
	<script type="text/javascript" src="vendor/jquery/jquery-3.2.1.min.js"></script>
	<script type="text/javascript" src="vendor/jquery/jquery.cookie.js"></script>
<!--===============================================================================================-->
	<script type="text/javascript" src="vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
	<script type="text/javascript" src="vendor/bootstrap/js/popper.js"></script>
	<script type="text/javascript" src="vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
	<script type="text/javascript" src="vendor/select2/select2.min.js"></script>
	<script type="text/javascript">
		$(".selection-1").select2({
			minimumResultsForSearch: 20,
			dropdownParent: $('#dropDownSelect1')
		});

		$(".selection-2").select2({
			minimumResultsForSearch: 20,
			dropdownParent: $('#dropDownSelect2')
		});
	</script>


<!--===============================================================================================-->
	<script src="js/main.js"></script>

	<script>
		function loadAllFunctions() {
			loadCart();
			loadHeader();
			load_cart_price();
			loadId();
		}
	
	
	</script>

<script> 
		function loadHeader() {
			sessionStorage.setItem("quantity",1);
			window.total_price = 0; //define variable total_price to calculate total bill
			var item_total = 0; //define variable item_total to calculate total price for that item
			let output = document.querySelector(".insert-header");

			//for(var n =0 ; n < cart.length; n ++) {

					 var item_price = cart.new_price;
					 var int_price = Number(item_price.replace(/[^0-9.-]+/g,""));

					item_total = int_price * 1; //item_price = price of item * quantity of items bought by customer
					total_price += item_total;

					output.innerHTML += 
				
					`<div class="header-cart-item-img">
						<img src="${cart.image_url}" alt="IMG">
					</div>

					<div class="header-cart-item-txt">
						<a href="#" class="header-cart-item-name">
							${cart.product_name}
						</a>

						<span class="header-cart-item-info">
							1 x ${cart.new_price}
						</span>
					</div>`

					
					item_total = 0;
		//	}
		total_price = Number(total_price).toFixed(2);
		document.querySelector("#total_price").innerHTML = "Total Price: $" + total_price	;
		document.getElementById("subtotal").innerHTML = "Subtotal: $" + total_price;

		}
		</script>	

<script>
		function loadCart() {
		
						var total_price = 0; //define variable total_price to calculate total bill
						var item_total = 0; //define variable item_total to calculate total price for that item
						let output = document.querySelector(".insert-item");
		
						//for(var i =0 ; i < cart.length; i ++) {
		
								item_price = cart.new_price; 
								var int_price = Number(item_price.replace(/[^0-9.-]+/g,""));
								item_total = int_price * 1; //item_price = price of item * quantity of items bought by customer
								item_total = Number(item_total).toFixed(2);
								total_price += int_price;
								output.innerHTML += 
							
									`<td class="column-1">
										<div class="cart-img-product b-rad-4 o-f-hidden">
											<img src=${cart.image_url} alt="IMG-PRODUCT">
										</div>
									</td>
									<td class="column-2">${cart.product_name}</td>
									<td class="column-3">${cart.new_price}</td>
									<td class="column-4">
										<div class="flex-w bo5 of-hidden w-size17">
											<button class="btn-num-product-down color1 flex-c-m size7 bg8 eff2">
												<i class="fs-12 fa fa-minus" aria-hidden="true"></i>
											</button>
		
											<input class="size8 m-text18 t-center num-product" value="1">
		
											<button class="btn-num-product-up color1 flex-c-m size7 bg8 eff2">
												<i class="fs-12 fa fa-plus" aria-hidden="true"></i>
											</button>
										</div>
									</td>
									<td class="column-5">$${item_total}</td>`
		
								item_total = 0; //resets item_price 
								
								//total_price = Number(total_price).toFixed(2);
								sessionStorage.setItem("total_price", total_price);
		
							//}
				
			}
</script>

<script>
		document.querySelector(".insert-item").addEventListener("click",(e)=>{
			let num = document.querySelector(".num-product").value;
			let id = document.querySelector(".num-product");
			let total_price = document.querySelector(".column-5");
			let price = sessionStorage.getItem("total_price");
			let cart_total = document.querySelector("#cart_total");

			if (e.target.classList.contains("btn-num-product-up")) {
				num++;
				id.value = num;
				sessionStorage.setItem("quantity",num);
				total_price.innerHTML = `$ ${price * num}`;
				cart_total.innerHTML = `$ ${price * num}`;
				let total = price * num;
				console.log(num);
				console.log(price);
				console.log(total);
				sessionStorage.setItem("total_total_price",total);
			}

			if (e.target.classList.contains("btn-num-product-down")) {
				if (num != 1) {
				num--;
				id.value = num;
				sessionStorage.setItem("quantity",num);
				total_price.innerHTML = `$ ${price * num}`;
				cart_total.innerHTML = `$ ${price * num}`;
				let total = price * num;
				sessionStorage.setItem("total_total_price",total);
			}
			sessionStorage.setItem("quantity",num);
		}
		})
</script>


<script>
                    
		function get_info(){
			var country = document.getElementById("slt_country").value;
			console.log(country);
			sessionStorage.setItem("country", country);

			var postal = document.getElementById("postal").value;
			console.log(postal);
			sessionStorage.setItem("postal", postal);

			window.location.assign("cart-shipping.html");
		}

		var subButton = document.getElementById('submit');
		subButton.addEventListener('click', get_info, false);
		
		function load_cart_price(){
		var total_price = sessionStorage.getItem("total_price");
		total_price = Number(total_price).toFixed(2);
		document.querySelector("#cart_total").innerHTML = "$" + total_price;
		}
		
	
		function loadId() {
        let id = sessionStorage.getItem("id");
        document.querySelector(".topbar-id").innerHTML = id;

      }
</script>



<script 
src="shipping.js">
</script>

</body>
</html>
